<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Introduction</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h3>Introduction</h3>

<p>This analysis looks at the weight lifting dataset provided by the Human Activity Recognition project (<a href="http://groupware.les.inf.puc-rio.br/har">http://groupware.les.inf.puc-rio.br/har</a>). This dataset contains accelerometer on various locations on participants lifting dumbbells. The purpose of this analysis is to recognize the manner in which the participant is lifting the barbell to see if we can accurately predict whether the weight lifting is being done properly or not.</p>

<pre><code>## Loading required package: caret
## Loading required package: lattice
## Loading required package: ggplot2
## Loading required package: e1071
</code></pre>

<h3>Data Processing</h3>

<p>We begin the analysis by importing both the training and test datasets. The full training dataset contains 19,622 observations across 160 variables. The test set contains an additional 20 observations. </p>

<pre><code class="r">test &lt;- read.csv(&quot;pml-testing.csv&quot;,stringsAsFactors = FALSE)
test$problem_id &lt;- as.factor(test$problem_id)

fullTrain &lt;- read.csv(&quot;pml-training.csv&quot;,stringsAsFactors = FALSE)
fullTrain$classe &lt;- as.factor(fullTrain$classe )
</code></pre>

<p>We then drop out variables that won&#39;t be useful for analysis. Namely, the id and timestamp variables which are merely identifiers of the activity recorded and have no external vailidiy. We also convert the &ldquo;yes/no&rdquo; variable (new_window) to a 0/1 dummy.</p>

<pre><code class="r">leanTrain &lt;- fullTrain[,-1:-5] 
leanTrain$new_window &lt;- ifelse(leanTrain$new_window == &quot;no&quot;,0,1)
</code></pre>

<p>There are multiple cases where there are blanks and &ldquo;#DIV/0&rdquo; values that caused numeric values to come in as character. These appear to come from some Excel calcualtions gone wrong. We convert them to numeric here.</p>

<pre><code class="r">charVars &lt;- sapply(leanTrain[1,],is.character)
leanTrain[,charVars] &lt;- suppressWarnings(lapply(leanTrain[,charVars],as.numeric))
</code></pre>

<p>Now we remove variables where the data are missing for more than 50% of values, as these are unlikely to provide value to the analysis. We also replicate the processing steps for the test set.</p>

<pre><code class="r">naFlag &lt;- sapply(leanTrain, function(x) sum(is.na(x))/length(x)) &gt;.5
leanTrain &lt;- leanTrain[,-which(naFlag)]

leanTest &lt;- test[,-1:-5] 
leanTest$new_window &lt;- ifelse(leanTest$new_window == &quot;no&quot;,0,1)
charVars &lt;- sapply(leanTest[1,],is.character)
leanTest[,charVars] &lt;- suppressWarnings(lapply(leanTest[,charVars],as.numeric))
naFlag &lt;- sapply(leanTest, function(x) sum(is.na(x))/length(x)) &gt;.5
leanTest &lt;- leanTest[,-which(naFlag)]
</code></pre>

<p>The analysis datasets now have 55 variables; quite trimmed down from the originals.</p>

<h3>Machine Learning Analysis</h3>

<p>We then create a validaton dataset to test our model against. Given that we do not have known values for the final test set, this dataset is necessary to quantify the likely out-of-sample error of our model. We use a 75/25 split here. A quick check shows that values of the dependent variable are comparable between the sets.</p>

<pre><code class="r">set.seed(15)
inTrain &lt;- createDataPartition(leanTrain$classe, p = 3/4)[[1]]

train &lt;- leanTrain[inTrain,]
validation &lt;- leanTrain[-inTrain,]

summary(train$classe)/length(train$classe)
</code></pre>

<pre><code>##      A      B      C      D      E 
## 0.2843 0.1935 0.1744 0.1639 0.1839
</code></pre>

<pre><code class="r">summary(validation$classe)/length(validation$classe)
</code></pre>

<pre><code>##      A      B      C      D      E 
## 0.2845 0.1935 0.1743 0.1639 0.1837
</code></pre>

<p>In order to lesssen the computational burden and maintain model parsimony, we prepocess the data. We scale and center the data as well as performing Box-Cox transformations to minimize the impact of outliers. We then use principal components analysis to reduce the number of explanatory variables. We use a threshold of 80% variance explained, yielding 13 components. As shown in the plot below, the first seven components explain the bulk of the variance in the data.</p>

<p>Transformations are done to all three data sets, using the preprocessing object calculated from the training set.</p>

<pre><code class="r">yIndex &lt;- length(names(train))
preproc &lt;- preProcess(train[,-yIndex], method=c(&quot;pca&quot;,&quot;center&quot;,&quot;scale&quot;,&quot;BoxCox&quot;),thresh=0.8)

preproc
</code></pre>

<pre><code>## 
## Call:
## preProcess.default(x = train[, -yIndex], method = c(&quot;pca&quot;,
##  &quot;center&quot;, &quot;scale&quot;, &quot;BoxCox&quot;), thresh = 0.8)
## 
## Created from 14718 samples and 54 variables
## Pre-processing: principal component signal extraction, centered,
##  scaled, Box-Cox transformation 
## 
## Lambda estimates for Box-Cox transformation:
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##    0.70    0.80    0.90    1.20    1.45    2.00      51 
## 
## PCA needed 13 components to capture 80 percent of the variance
</code></pre>

<pre><code class="r">#This code is a lot of trouble just to see the PCA output (have to use prcomp)
preprocNoPCA &lt;-preproc &lt;- preProcess(train[,-yIndex], method=c(&quot;center&quot;,&quot;scale&quot;,&quot;BoxCox&quot;))
plot(prcomp(predict(preprocNoPCA,train[,-yIndex],),center=FALSE), type=&quot;l&quot;,main=&quot;Principal Components&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-7"/> </p>

<pre><code class="r">trainPC &lt;- predict(preproc,train[-yIndex])
validationPC &lt;- predict(preproc,validation[-yIndex])
testPC &lt;- predict(preproc,leanTest[-yIndex])
</code></pre>

<p>We then estimate the model parameters. Here we use a random forest, estimated on the training set. Parameters are optimized using a single-fold, 75/25 cross-validation. Other model forms (trees, boosting, and Naive Bayes) were used in initial runs, but yielded much less fruitful results. For brevity (and out of concern for computing power), those results are not included here.</p>

<pre><code class="r">tc &lt;- trainControl(method=&quot;cv&quot;)

modelPCARF &lt;- train(train$classe ~ .,data=trainPC, method=&quot;rf&quot;,trControl=tc)
</code></pre>

<pre><code>## Loading required package: randomForest
## randomForest 4.6-10
## Type rfNews() to see new features/changes/bug fixes.
</code></pre>

<pre><code class="r">plot(modelPCARF)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"/> </p>

<pre><code class="r">confusion &lt;- confusionMatrix(validation$classe,predict(modelPCARF,validationPC))
confusion
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1394    1    0    0    0
##          B    1  947    1    0    0
##          C    0    1  854    0    0
##          D    0    0    2  801    1
##          E    0    0    0    0  901
## 
## Overall Statistics
##                                         
##                Accuracy : 0.999         
##                  95% CI : (0.997, 0.999)
##     No Information Rate : 0.284         
##     P-Value [Acc &gt; NIR] : &lt;2e-16        
##                                         
##                   Kappa : 0.998         
##  Mcnemar&#39;s Test P-Value : NA            
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity             0.999    0.998    0.996    1.000    0.999
## Specificity             1.000    0.999    1.000    0.999    1.000
## Pos Pred Value          0.999    0.998    0.999    0.996    1.000
## Neg Pred Value          1.000    0.999    0.999    1.000    1.000
## Prevalence              0.284    0.194    0.175    0.163    0.184
## Detection Rate          0.284    0.193    0.174    0.163    0.184
## Detection Prevalence    0.284    0.194    0.174    0.164    0.184
## Balanced Accuracy       0.999    0.999    0.998    1.000    0.999
</code></pre>

<pre><code class="r">ggplot(data=data.frame(confusion$table)) + geom_tile(aes(x=Prediction, y=Reference, fill=Freq)) + labs(fill=&quot;Frequency&quot;) + scale_fill_gradient(breaks=seq(from=0, to=1500, by=300)) 
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-9"/> </p>

<p>As seen in the plot above, the model does a very good job of classifying in the validation data set. According to the confusion matrix analysis, the estimated out-of-sample accuracy is quite high at approximately 97% overall. This is signficantly higher than the no information rate of 28%. </p>

<p>These results seem to indicate a well-behaved model. This was further confirmed in the test set, where all 20 observations were correctly classified.</p>

</body>

</html>

